import{s as i,j as e}from"./supabase.BjDmEivz.js";import{r as c}from"./index.DiEladB3.js";function I(a){return a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-")}function W(a){return a===0?1:a+2}function G(a){return`photo-${String(a).padStart(2,"0")}.jpg`}const U={small:"Pequeno",medium:"MÃ©dio",large:"Grande"},O={male:"Macho",female:"FÃªmea"},T={name:"",size:"medium",sex:"",age:"",description:"",personality:"",story:"",breed:"",entryDate:"",socHumans:"unknown",socMales:"unknown",socFemales:"unknown",socCats:"unknown",chipped:!1,vaccinated:!1,sterilized:!1},Y={male:"Masculino",female:"Feminino"},J={small:"Pequeno",medium:"MÃ©dio",large:"Grande"};function X(a){const t=[],r=Y[a.sex];r&&t.push(`Sexo: ${r}`),a.age&&t.push(`Idade: ${a.age}`),a.entryDate&&t.push(`Data de entrada: ${a.entryDate}`),a.breed&&t.push(`RaÃ§a: ${a.breed}`),t.push(`Porte: ${J[a.size]??a.size}`),a.personality&&t.push(`Personalidade: ${a.personality}`),a.socHumans==="yes"?t.push("SociÃ¡vel com humanos"):a.socHumans==="no"?t.push("NÃ£o sociÃ¡vel com humanos"):t.push("NÃ£o sabemos se Ã© sociÃ¡vel com humanos"),a.socMales==="yes"?t.push("SociÃ¡vel com machos"):a.socMales==="no"?t.push("NÃ£o sociÃ¡vel com machos"):t.push("NÃ£o sabemos se Ã© sociÃ¡vel com machos"),a.socFemales==="yes"?t.push("SociÃ¡vel com fÃªmeas"):a.socFemales==="no"?t.push("NÃ£o sociÃ¡vel com fÃªmeas"):t.push("NÃ£o sabemos se Ã© sociÃ¡vel com fÃªmeas"),a.socCats==="yes"?t.push("SociÃ¡vel com gatos"):a.socCats==="no"?t.push("NÃ£o sociÃ¡vel com gatos"):t.push("NÃ£o sabemos se Ã© sociÃ¡vel com gatos");const m=[];return a.chipped&&m.push("Chipado"),a.vaccinated&&m.push("Vacinado"),a.sterilized&&m.push("Esterilizado"),m.length>0&&t.push(m.join(", ")),a.story&&t.push(`HistÃ³ria: ${a.story}`),t.join(`
`)}function Z(a,t){const r={...t},m=a.split(`
`).filter(Boolean),l=[];for(const d of m){const n=d.match(/^([^:]+):\s*(.+)$/);if(n){const o=n[1].trim().toLowerCase(),x=n[2].trim();o==="personalidade"?r.personality=x:o==="histÃ³ria"?r.story=x:o==="raÃ§a"?r.breed=x:o==="data de entrada"&&(r.entryDate=x)}else{const o=d.trim();o==="SociÃ¡vel com humanos"?r.socHumans="yes":o==="NÃ£o sociÃ¡vel com humanos"?r.socHumans="no":o==="NÃ£o sabemos se Ã© sociÃ¡vel com humanos"?r.socHumans="unknown":o==="SociÃ¡vel com machos"?r.socMales="yes":o==="NÃ£o sociÃ¡vel com machos"?r.socMales="no":o==="NÃ£o sabemos se Ã© sociÃ¡vel com machos"?r.socMales="unknown":o==="SociÃ¡vel com fÃªmeas"?r.socFemales="yes":o==="NÃ£o sociÃ¡vel com fÃªmeas"?r.socFemales="no":o==="NÃ£o sabemos se Ã© sociÃ¡vel com fÃªmeas"?r.socFemales="unknown":o==="SociÃ¡vel com gatos"?r.socCats="yes":o==="NÃ£o sociÃ¡vel com gatos"?r.socCats="no":o==="NÃ£o sabemos se Ã© sociÃ¡vel com gatos"?r.socCats="unknown":o.match(/^(Chipado|Vacinado|Esterilizado)/)?(o.includes("Chipado")&&(r.chipped=!0),o.includes("Vacinado")&&(r.vaccinated=!0),o.includes("Esterilizado")&&(r.sterilized=!0)):l.push(o)}}return l.length>0&&!r.story&&(r.story=l.join(" ")),r}function P({size:a="sm"}){const t=a==="lg"?"h-8 w-8":"h-4 w-4";return e.jsxs("svg",{className:`${t} animate-spin text-current`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})}function K({onLogin:a}){const[t,r]=c.useState(""),[m,l]=c.useState(""),[d,n]=c.useState(""),[o,x]=c.useState(!1);async function j(g){if(g.preventDefault(),!!i){n(""),x(!0);try{const{error:w}=await i.auth.signInWithPassword({email:t,password:m});w?n("Email ou palavra-passe incorretos."):a()}catch{n("Erro ao entrar. Tente novamente.")}finally{x(!1)}}}return e.jsx("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-3xl",children:"ðŸ¾"})}),e.jsx("h1",{className:"text-2xl font-bold text-warm-900",children:"CAPA PVL"}),e.jsx("p",{className:"text-warm-500 text-sm mt-1",children:"Ãrea de AdministraÃ§Ã£o"})]}),e.jsxs("form",{onSubmit:j,className:"bg-white rounded-2xl shadow-sm border border-warm-200 p-8 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:g=>r(g.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 transition-colors",placeholder:"admin@capapvl.pt"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Palavra-passe"}),e.jsx("input",{id:"password",type:"password",value:m,onChange:g=>l(g.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 transition-colors",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),d&&e.jsx("p",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl px-4 py-3",children:d}),e.jsxs("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center gap-2 bg-primary-500 hover:bg-primary-600 disabled:opacity-60 text-white font-semibold py-3 rounded-xl transition-colors",children:[o?e.jsx(P,{}):null,o?"A entrarâ€¦":"Entrar"]})]})]})})}function B({initial:a,existingDog:t,onSave:r,onCancel:m}){const[l,d]=c.useState(a),[n,o]=c.useState([]),[x,j]=c.useState([]),[g,w]=c.useState(null),[y,A]=c.useState(!1),[E,k]=c.useState(""),N=c.useRef(null),h=!!t;c.useEffect(()=>{!h||!i||!t||z(I(t.name))},[h,t]);async function z(s){if(!i)return;const{data:u,error:p}=await i.storage.from("dog-photos").list(s,{sortBy:{column:"name",order:"asc"}});if(p||!u)return;const F=u.filter(C=>C.name.endsWith(".jpg")||C.name.endsWith(".jpeg")||C.name.endsWith(".png")||C.name.endsWith(".webp")).map(C=>{const f=`${s}/${C.name}`,{data:S}=i.storage.from("dog-photos").getPublicUrl(f);return{path:f,url:S.publicUrl}});j(F)}async function M(s){if(i){w(s);try{await i.storage.from("dog-photos").remove([s]),j(u=>u.filter(p=>p.path!==s))}finally{w(null)}}}async function L(s){if(s.preventDefault(),!!i){k(""),A(!0);try{const u=I(l.name||(t?.name??""));let p=t?.photo_url??"";if(n.length>0){let f=0;if(h){const b=x.map($=>{const D=$.path.match(/photo-(\d+)\./);return D?parseInt(D[1],10):0}),v=b.length>0?Math.max(...b):0;v===0?f=0:v===1?f=1:f=v-1}const S=[];for(let b=0;b<n.length;b++){const v=f+b,$=W(v),D=G($),H=`${u}/${D}`,R=n[b],{error:q}=await i.storage.from("dog-photos").upload(H,R,{upsert:!0,contentType:R.type||"image/jpeg"});if(!q){const{data:V}=i.storage.from("dog-photos").getPublicUrl(H);S.push(V.publicUrl)}}(S.length>0&&!p||S.length>0&&!h)&&(p=S[0])}if(h){const f=x.filter(b=>b.url!==t?.photo_url);!x.find(b=>b.url===p)&&!p.includes(u)&&(p=x.length>0?x[0].url:"");const{data:S}=await i.storage.from("dog-photos").list(u,{sortBy:{column:"name",order:"asc"}});if(S&&S.length>0){const b=S.find(v=>v.name.endsWith(".jpg")||v.name.endsWith(".jpeg")||v.name.endsWith(".png")||v.name.endsWith(".webp"));if(b&&!p){const{data:v}=i.storage.from("dog-photos").getPublicUrl(`${u}/${b.name}`);p=v.publicUrl}}}const F=X(l),C={name:l.name,size:l.size,sex:l.sex||null,age:l.age,description:F,photo_url:p,updated_at:new Date().toISOString()};if(h&&t){const{error:f}=await i.from("dogs").update(C).eq("id",t.id);if(f)throw f}else{const{error:f}=await i.from("dogs").insert({...C,is_adopted:!1});if(f)throw f}r()}catch(u){k(u?.message??"Erro ao guardar. Tente novamente.")}finally{A(!1)}}}function _(s){const u=Array.from(s.target.files??[]);o(u)}return e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[E&&e.jsx("p",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl px-4 py-3",children:E}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Nome *"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>d({...l,name:s.target.value}),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: Bolinha"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"SubtÃ­tulo (personalidade)"}),e.jsx("input",{type:"text",value:l.personality,onChange:s=>d({...l,personality:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: Companheiro, muito meigo e ativo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Tamanho"}),e.jsxs("select",{value:l.size,onChange:s=>d({...l,size:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"small",children:"Pequeno"}),e.jsx("option",{value:"medium",children:"MÃ©dio"}),e.jsx("option",{value:"large",children:"Grande"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Sexo"}),e.jsxs("select",{value:l.sex,onChange:s=>d({...l,sex:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"",children:"Desconhecido"}),e.jsx("option",{value:"female",children:"FÃªmea"}),e.jsx("option",{value:"male",children:"Macho"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Idade"}),e.jsx("input",{type:"text",value:l.age,onChange:s=>d({...l,age:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: 3 anos"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"RaÃ§a"}),e.jsx("input",{type:"text",value:l.breed,onChange:s=>d({...l,breed:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: Indefinida, Labrador, Cruzado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Data de entrada"}),e.jsx("input",{type:"text",value:l.entryDate,onChange:s=>d({...l,entryDate:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: 2023, Janeiro 2024"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"HistÃ³ria"}),e.jsx("textarea",{value:l.story,onChange:s=>d({...l,story:s.target.value}),rows:4,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 resize-y",placeholder:"Conta a histÃ³ria do cÃ£oâ€¦"})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{className:"text-sm font-semibold text-warm-700 mb-3",children:"Compatibilidade"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[["socHumans","Humanos"],["socMales","Machos"],["socFemales","FÃªmeas"],["socCats","Gatos"]].map(([s,u])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-warm-700 w-20",children:u}),e.jsxs("select",{value:l[s],onChange:p=>d({...l,[s]:p.target.value}),className:"flex-1 px-3 py-2 rounded-lg border border-warm-200 bg-warm-50 text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"unknown",children:"NÃ£o sabemos"}),e.jsx("option",{value:"yes",children:"SociÃ¡vel"}),e.jsx("option",{value:"no",children:"NÃ£o sociÃ¡vel"})]})]},s))})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{className:"text-sm font-semibold text-warm-700 mb-3",children:"Estado mÃ©dico"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:[["chipped","Chipado"],["vaccinated","Vacinado"],["sterilized","Esterilizado"]].map(([s,u])=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l[s],onChange:p=>d({...l,[s]:p.target.checked}),className:"w-4 h-4 rounded border-warm-300 text-primary-500 focus:ring-primary-400"}),e.jsx("span",{className:"text-sm text-warm-700",children:u})]},s))})]}),h&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-warm-700 mb-3",children:["Fotos atuais",x.length>0&&e.jsxs("span",{className:"ml-2 text-warm-400 font-normal",children:["(",x.length," fotos)"]})]}),x.length===0?e.jsx("p",{className:"text-sm text-warm-400 italic",children:"Nenhuma foto carregada."}):e.jsx("div",{className:"flex flex-wrap gap-3",children:x.map(s=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.url,alt:"",className:"w-20 h-20 object-cover rounded-xl border border-warm-200",loading:"lazy"}),e.jsx("button",{type:"button",onClick:()=>M(s.path),disabled:g===s.path,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",title:"Eliminar foto",children:g===s.path?"â€¦":"Ã—"})]},s.path))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:h?"Adicionar novas fotos":"Fotos"}),e.jsxs("div",{className:"border-2 border-dashed border-warm-300 rounded-xl p-6 text-center cursor-pointer hover:border-primary-400 hover:bg-primary-50 transition-colors",onClick:()=>N.current?.click(),children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“·"}),e.jsx("p",{className:"text-sm text-warm-600 font-medium",children:n.length>0?`${n.length} ficheiro(s) selecionado(s)`:"Clica para selecionar fotos"}),e.jsx("p",{className:"text-xs text-warm-400 mt-1",children:"JPG, PNG, WebP â€” mÃºltiplos ficheiros permitidos"})]}),e.jsx("input",{ref:N,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:n.map((s,u)=>e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary-50 text-primary-700 text-xs font-medium px-3 py-1.5 rounded-lg border border-primary-200",children:[e.jsx("span",{children:"ðŸ–¼"}),e.jsx("span",{className:"truncate max-w-32",children:s.name})]},u))})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs("button",{type:"submit",disabled:y,className:"flex items-center gap-2 bg-primary-500 hover:bg-primary-600 disabled:opacity-60 text-white font-semibold px-6 py-3 rounded-xl transition-colors",children:[y?e.jsx(P,{}):null,y?"A guardarâ€¦":h?"Guardar AlteraÃ§Ãµes":"Adicionar CÃ£o"]}),e.jsx("button",{type:"button",onClick:m,disabled:y,className:"px-6 py-3 rounded-xl border border-warm-200 text-warm-700 font-semibold hover:bg-warm-100 transition-colors",children:"Cancelar"})]})]})}function Q({dog:a,onConfirm:t,onCancel:r,deleting:m}){return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-warm-200 p-8 w-full max-w-md",children:[e.jsx("div",{className:"text-4xl mb-4 text-center",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-warm-900 text-center mb-2",children:"Eliminar CÃ£o"}),e.jsxs("p",{className:"text-warm-600 text-sm text-center mb-2",children:["Tens a certeza que queres eliminar ",e.jsx("strong",{className:"text-warm-900",children:a.name}),"?"]}),e.jsx("p",{className:"text-red-600 text-xs text-center bg-red-50 border border-red-200 rounded-xl px-4 py-3 mb-6",children:"Esta aÃ§Ã£o Ã© permanente. Todos os dados e fotos serÃ£o eliminados e nÃ£o podem ser recuperados."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:t,disabled:m,className:"flex-1 flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 disabled:opacity-60 text-white font-semibold py-3 rounded-xl transition-colors",children:[m?e.jsx(P,{}):null,m?"A eliminarâ€¦":"Sim, eliminar"]}),e.jsx("button",{onClick:r,disabled:m,className:"flex-1 py-3 rounded-xl border border-warm-200 text-warm-700 font-semibold hover:bg-warm-100 transition-colors",children:"Cancelar"})]})]})})}function ee({dogs:a,onRefresh:t,onAdd:r,onEdit:m,onLogout:l}){const[d,n]=c.useState(""),[o,x]=c.useState("all"),[j,g]=c.useState("all"),[w,y]=c.useState("all"),[A,E]=c.useState(null),[k,N]=c.useState(null),[h,z]=c.useState(!1),M=a.filter(s=>!(o!=="all"&&s.size!==o||j!=="all"&&s.sex!==j||w==="available"&&s.is_adopted||w==="adopted"&&!s.is_adopted||d&&!s.name.toLowerCase().includes(d.toLowerCase())));async function L(s){if(!(!i||A)){E(s.id);try{await i.from("dogs").update({is_adopted:!s.is_adopted,updated_at:new Date().toISOString()}).eq("id",s.id),t()}finally{E(null)}}}async function _(s){if(i){z(!0);try{const u=I(s.name),{data:p}=await i.storage.from("dog-photos").list(u);if(p&&p.length>0){const F=p.map(C=>`${u}/${C.name}`);await i.storage.from("dog-photos").remove(F)}await i.from("dogs").delete().eq("id",s.id),N(null),t()}finally{z(!1)}}}return e.jsxs(e.Fragment,{children:[k&&e.jsx(Q,{dog:k,onConfirm:()=>_(k),onCancel:()=>!h&&N(null),deleting:h}),e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ¾"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-warm-900 text-sm",children:"CAPA PVL"}),e.jsx("span",{className:"text-warm-400 text-xs ml-2",children:"Admin"})]})]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-sm text-warm-600 hover:text-warm-900 font-medium px-3 py-2 rounded-lg hover:bg-warm-100 transition-colors",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:[e.jsx("path",{fillRule:"evenodd",d:"M3 4.25A2.25 2.25 0 015.25 2h5.5A2.25 2.25 0 0113 4.25v2a.75.75 0 01-1.5 0v-2a.75.75 0 00-.75-.75h-5.5a.75.75 0 00-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 00.75-.75v-2a.75.75 0 011.5 0v2A2.25 2.25 0 0110.75 18h-5.5A2.25 2.25 0 013 15.75V4.25z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M19 10a.75.75 0 00-.75-.75H8.704l1.048-1.04a.75.75 0 10-1.004-1.115l-2.5 2.25a.75.75 0 000 1.11l2.5 2.25a.75.75 0 101.004-1.115l-1.048-1.04h9.546A.75.75 0 0019 10z",clipRule:"evenodd"})]}),"Sair"]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-warm-900",children:"CÃ£es"}),e.jsxs("p",{className:"text-warm-500 text-sm mt-0.5",children:[a.length," total Â· ",a.filter(s=>!s.is_adopted).length," disponÃ­veis Â· ",a.filter(s=>s.is_adopted).length," adotados"]})]}),e.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-primary-500 hover:bg-primary-600 text-white font-semibold px-5 py-2.5 rounded-xl transition-colors shadow-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})}),"Adicionar CÃ£o"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4 text-warm-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("path",{fillRule:"evenodd",d:"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z",clipRule:"evenodd"})}),e.jsx("input",{type:"search",value:d,onChange:s=>n(s.target.value),placeholder:"Pesquisar por nomeâ€¦",className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-warm-200 bg-white text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400"})]}),e.jsxs("select",{value:o,onChange:s=>x(s.target.value),className:"px-4 py-2.5 rounded-xl border border-warm-200 bg-white text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"all",children:"Todos os tamanhos"}),e.jsx("option",{value:"small",children:"Pequeno"}),e.jsx("option",{value:"medium",children:"MÃ©dio"}),e.jsx("option",{value:"large",children:"Grande"})]}),e.jsxs("select",{value:j,onChange:s=>g(s.target.value),className:"px-4 py-2.5 rounded-xl border border-warm-200 bg-white text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"all",children:"Todos os sexos"}),e.jsx("option",{value:"male",children:"â™‚ Macho"}),e.jsx("option",{value:"female",children:"â™€ FÃªmea"})]}),e.jsxs("select",{value:w,onChange:s=>y(s.target.value),className:"px-4 py-2.5 rounded-xl border border-warm-200 bg-white text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"all",children:"Todos os estados"}),e.jsx("option",{value:"available",children:"DisponÃ­vel"}),e.jsx("option",{value:"adopted",children:"Adotado"})]}),(o!=="all"||j!=="all"||w!=="all")&&e.jsx("button",{onClick:()=>{x("all"),g("all"),y("all")},className:"text-sm text-warm-500 hover:text-warm-700 font-medium px-3 py-2.5 rounded-xl hover:bg-warm-100 transition-colors whitespace-nowrap",children:"Limpar filtros"})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm overflow-hidden",children:M.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ¾"}),e.jsx("p",{className:"text-warm-500 font-medium",children:"Nenhum cÃ£o encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-warm-100 bg-warm-50",children:[e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3 w-14",children:"Foto"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3",children:"Nome"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden sm:table-cell",children:"Tamanho"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden md:table-cell",children:"Sexo"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden lg:table-cell",children:"Idade"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3",children:"Estado"}),e.jsx("th",{className:"text-right text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3",children:"AÃ§Ãµes"})]})}),e.jsx("tbody",{className:"divide-y divide-warm-100",children:M.map(s=>e.jsxs("tr",{className:`hover:bg-warm-50 transition-colors ${s.is_adopted?"opacity-50":""}`,children:[e.jsx("td",{className:"px-5 py-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-warm-100 flex-shrink-0",children:s.photo_url?e.jsx("img",{src:s.photo_url,alt:s.name,className:"w-full h-full object-cover",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-warm-300 text-lg",children:"ðŸ¶"})})}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:"font-semibold text-warm-900",children:s.name})}),e.jsx("td",{className:"px-4 py-3 hidden sm:table-cell",children:e.jsx("span",{className:"text-warm-600",children:U[s.size]??s.size})}),e.jsx("td",{className:"px-4 py-3 hidden md:table-cell",children:e.jsx("span",{className:"text-warm-600",children:s.sex?O[s.sex]:"â€”"})}),e.jsx("td",{className:"px-4 py-3 hidden lg:table-cell",children:e.jsx("span",{className:"text-warm-600",children:s.age||"â€”"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>L(s),disabled:A===s.id,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-colors ${s.is_adopted?"bg-nature-100 text-nature-700 hover:bg-nature-200":"bg-primary-100 text-primary-700 hover:bg-primary-200"}`,title:s.is_adopted?"Marcar como disponÃ­vel":"Marcar como adotado",children:[A===s.id?e.jsx(P,{size:"sm"}):e.jsx("span",{children:s.is_adopted?"âœ“":"â—‹"}),s.is_adopted?"Adotado":"DisponÃ­vel"]})}),e.jsx("td",{className:"px-5 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>m(s),className:"p-2 text-warm-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Editar",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:[e.jsx("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),e.jsx("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"})]})}),e.jsx("button",{onClick:()=>N(s),className:"p-2 text-warm-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})})]},s.id))})]})})}),e.jsxs("p",{className:"text-xs text-warm-400 text-center mt-6",children:[M.length," de ",a.length," cÃ£o(Ãµes) listados"]})]})]})]})}function te(){const[a,t]=c.useState(!1),[r,m]=c.useState(!1),[l,d]=c.useState("dashboard"),[n,o]=c.useState(null),[x,j]=c.useState([]),[g,w]=c.useState(!1);c.useEffect(()=>{if(!i){t(!0);return}i.auth.getUser().then(({data:z})=>{m(!!z.user),t(!0)});const{data:{subscription:h}}=i.auth.onAuthStateChange((z,M)=>{m(!!M?.user)});return()=>h.unsubscribe()},[]),c.useEffect(()=>{r&&y()},[r]);async function y(){if(i){w(!0);try{const{data:h}=await i.from("dogs").select("*").order("created_at",{ascending:!1});j(h??[])}finally{w(!1)}}}async function A(){i&&(await i.auth.signOut(),m(!1),d("dashboard"))}function E(h){o(h),d("edit")}function k(){d("dashboard"),o(null),y()}function N(){d("dashboard"),o(null)}if(!a)return e.jsx("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center",children:e.jsx(P,{size:"lg"})});if(!r)return e.jsx(K,{onLogin:()=>m(!0)});if(l==="add")return e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center gap-3",children:[e.jsx("button",{onClick:N,className:"p-2 text-warm-500 hover:text-warm-900 hover:bg-warm-100 rounded-lg transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-warm-900 text-sm",children:"Adicionar CÃ£o"}),e.jsx("p",{className:"text-warm-400 text-xs",children:"Novo registo"})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm p-6 sm:p-8",children:e.jsx(B,{initial:T,onSave:k,onCancel:N})})})]});if(l==="edit"&&n){const h={...T,name:n.name,size:n.size,sex:n.sex??"",age:n.age??"",description:n.description??""},z=n.description?Z(n.description,h):h;return e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center gap-3",children:[e.jsx("button",{onClick:N,className:"p-2 text-warm-500 hover:text-warm-900 hover:bg-warm-100 rounded-lg transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"font-bold text-warm-900 text-sm",children:["Editar: ",n.name]}),e.jsx("p",{className:"text-warm-400 text-xs",children:"Alterar informaÃ§Ãµes"})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm p-6 sm:p-8",children:e.jsx(B,{initial:z,existingDog:n,onSave:k,onCancel:N})})})]})}return g?e.jsxs("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center gap-3 text-warm-500",children:[e.jsx(P,{size:"lg"}),e.jsx("span",{className:"font-medium",children:"A carregarâ€¦"})]}):e.jsx(ee,{dogs:x,onRefresh:y,onAdd:()=>d("add"),onEdit:E,onLogout:A})}export{te as default};
