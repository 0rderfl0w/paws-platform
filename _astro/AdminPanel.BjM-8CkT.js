import{s as r,j as e}from"./supabase.BjDmEivz.js";import{r as a}from"./index.DiEladB3.js";function F(n){return n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-")}function W(n){return n===0?1:n+2}function H(n){return`photo-${String(n).padStart(2,"0")}.jpg`}const U={small:"Pequeno",medium:"MÃ©dio",large:"Grande"},V={male:"Macho",female:"FÃªmea"},G={name:"",size:"medium",sex:"",age:"",description:""};function E({size:n="sm"}){const o=n==="lg"?"h-8 w-8":"h-4 w-4";return e.jsxs("svg",{className:`${o} animate-spin text-current`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})}function O({onLogin:n}){const[o,v]=a.useState(""),[h,l]=a.useState(""),[m,i]=a.useState(""),[b,x]=a.useState(!1);async function y(f){if(f.preventDefault(),!!r){i(""),x(!0);try{const{error:C}=await r.auth.signInWithPassword({email:o,password:h});C?i("Email ou palavra-passe incorretos."):n()}catch{i("Erro ao entrar. Tente novamente.")}finally{x(!1)}}}return e.jsx("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-2xl mb-4",children:e.jsx("span",{className:"text-3xl",children:"ðŸ¾"})}),e.jsx("h1",{className:"text-2xl font-bold text-warm-900",children:"CAPA PVL"}),e.jsx("p",{className:"text-warm-500 text-sm mt-1",children:"Ãrea de AdministraÃ§Ã£o"})]}),e.jsxs("form",{onSubmit:y,className:"bg-white rounded-2xl shadow-sm border border-warm-200 p-8 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:o,onChange:f=>v(f.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 transition-colors",placeholder:"admin@capapvl.pt"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Palavra-passe"}),e.jsx("input",{id:"password",type:"password",value:h,onChange:f=>l(f.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 transition-colors",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),m&&e.jsx("p",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl px-4 py-3",children:m}),e.jsxs("button",{type:"submit",disabled:b,className:"w-full flex items-center justify-center gap-2 bg-primary-500 hover:bg-primary-600 disabled:opacity-60 text-white font-semibold py-3 rounded-xl transition-colors",children:[b?e.jsx(E,{}):null,b?"A entrarâ€¦":"Entrar"]})]})]})})}function T({initial:n,existingDog:o,onSave:v,onCancel:h}){const[l,m]=a.useState(n),[i,b]=a.useState([]),[x,y]=a.useState([]),[f,C]=a.useState(null),[N,S]=a.useState(!1),[z,k]=a.useState(""),t=a.useRef(null),d=!!o;a.useEffect(()=>{!d||!r||!o||A(F(o.name))},[d,o]);async function A(s){if(!r)return;const{data:p,error:g}=await r.storage.from("dog-photos").list(s,{sortBy:{column:"name",order:"asc"}});if(g||!p)return;const M=p.filter(c=>c.name.endsWith(".jpg")||c.name.endsWith(".jpeg")||c.name.endsWith(".png")||c.name.endsWith(".webp")).map(c=>{const w=`${s}/${c.name}`,{data:u}=r.storage.from("dog-photos").getPublicUrl(w);return{path:w,url:u.publicUrl}});y(M)}async function P(s){if(r){C(s);try{await r.storage.from("dog-photos").remove([s]),y(p=>p.filter(g=>g.path!==s))}finally{C(null)}}}async function L(s){if(s.preventDefault(),!!r){k(""),S(!0);try{const p=F(l.name||(o?.name??""));let g=o?.photo_url??"";if(i.length>0){let c=0;if(d){const u=x.map(D=>{const _=D.path.match(/photo-(\d+)\./);return _?parseInt(_[1],10):0}),j=u.length>0?Math.max(...u):0;j===0?c=0:j===1?c=1:c=j-1}const w=[];for(let u=0;u<i.length;u++){const j=c+u,D=W(j),_=H(D),R=`${p}/${_}`,I=i[u],{error:$}=await r.storage.from("dog-photos").upload(R,I,{upsert:!0,contentType:I.type||"image/jpeg"});if(!$){const{data:q}=r.storage.from("dog-photos").getPublicUrl(R);w.push(q.publicUrl)}}(w.length>0&&!g||w.length>0&&!d)&&(g=w[0])}if(d){const c=x.filter(u=>u.url!==o?.photo_url);!x.find(u=>u.url===g)&&!g.includes(p)&&(g=x.length>0?x[0].url:"");const{data:w}=await r.storage.from("dog-photos").list(p,{sortBy:{column:"name",order:"asc"}});if(w&&w.length>0){const u=w.find(j=>j.name.endsWith(".jpg")||j.name.endsWith(".jpeg")||j.name.endsWith(".png")||j.name.endsWith(".webp"));if(u&&!g){const{data:j}=r.storage.from("dog-photos").getPublicUrl(`${p}/${u.name}`);g=j.publicUrl}}}const M={name:l.name,size:l.size,sex:l.sex||null,age:l.age,description:l.description,photo_url:g,updated_at:new Date().toISOString()};if(d&&o){const{error:c}=await r.from("dogs").update(M).eq("id",o.id);if(c)throw c}else{const{error:c}=await r.from("dogs").insert({...M,is_adopted:!1});if(c)throw c}v()}catch(p){k(p?.message??"Erro ao guardar. Tente novamente.")}finally{S(!1)}}}function B(s){const p=Array.from(s.target.files??[]);b(p)}return e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[z&&e.jsx("p",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-xl px-4 py-3",children:z}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Nome *"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>m({...l,name:s.target.value}),required:!0,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: Bolinha"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Tamanho"}),e.jsxs("select",{value:l.size,onChange:s=>m({...l,size:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"small",children:"Pequeno"}),e.jsx("option",{value:"medium",children:"MÃ©dio"}),e.jsx("option",{value:"large",children:"Grande"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Sexo"}),e.jsxs("select",{value:l.sex,onChange:s=>m({...l,sex:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",children:[e.jsx("option",{value:"",children:"Desconhecido"}),e.jsx("option",{value:"female",children:"FÃªmea"}),e.jsx("option",{value:"male",children:"Macho"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"Idade"}),e.jsx("input",{type:"text",value:l.age,onChange:s=>m({...l,age:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400",placeholder:"Ex: 3 anos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:"DescriÃ§Ã£o"}),e.jsx("textarea",{value:l.description,onChange:s=>m({...l,description:s.target.value}),rows:5,className:"w-full px-4 py-3 rounded-xl border border-warm-200 bg-warm-50 text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400 resize-y",placeholder:"Conta a histÃ³ria do cÃ£o, personalidade, compatibilidadesâ€¦"})]}),d&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-warm-700 mb-3",children:["Fotos atuais",x.length>0&&e.jsxs("span",{className:"ml-2 text-warm-400 font-normal",children:["(",x.length," fotos)"]})]}),x.length===0?e.jsx("p",{className:"text-sm text-warm-400 italic",children:"Nenhuma foto carregada."}):e.jsx("div",{className:"flex flex-wrap gap-3",children:x.map(s=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.url,alt:"",className:"w-20 h-20 object-cover rounded-xl border border-warm-200",loading:"lazy"}),e.jsx("button",{type:"button",onClick:()=>P(s.path),disabled:f===s.path,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",title:"Eliminar foto",children:f===s.path?"â€¦":"Ã—"})]},s.path))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-warm-700 mb-1.5",children:d?"Adicionar novas fotos":"Fotos"}),e.jsxs("div",{className:"border-2 border-dashed border-warm-300 rounded-xl p-6 text-center cursor-pointer hover:border-primary-400 hover:bg-primary-50 transition-colors",onClick:()=>t.current?.click(),children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ“·"}),e.jsx("p",{className:"text-sm text-warm-600 font-medium",children:i.length>0?`${i.length} ficheiro(s) selecionado(s)`:"Clica para selecionar fotos"}),e.jsx("p",{className:"text-xs text-warm-400 mt-1",children:"JPG, PNG, WebP â€” mÃºltiplos ficheiros permitidos"})]}),e.jsx("input",{ref:t,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:B}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:i.map((s,p)=>e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary-50 text-primary-700 text-xs font-medium px-3 py-1.5 rounded-lg border border-primary-200",children:[e.jsx("span",{children:"ðŸ–¼"}),e.jsx("span",{className:"truncate max-w-32",children:s.name})]},p))})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsxs("button",{type:"submit",disabled:N,className:"flex items-center gap-2 bg-primary-500 hover:bg-primary-600 disabled:opacity-60 text-white font-semibold px-6 py-3 rounded-xl transition-colors",children:[N?e.jsx(E,{}):null,N?"A guardarâ€¦":d?"Guardar AlteraÃ§Ãµes":"Adicionar CÃ£o"]}),e.jsx("button",{type:"button",onClick:h,disabled:N,className:"px-6 py-3 rounded-xl border border-warm-200 text-warm-700 font-semibold hover:bg-warm-100 transition-colors",children:"Cancelar"})]})]})}function J({dog:n,onConfirm:o,onCancel:v,deleting:h}){return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-warm-200 p-8 w-full max-w-md",children:[e.jsx("div",{className:"text-4xl mb-4 text-center",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-warm-900 text-center mb-2",children:"Eliminar CÃ£o"}),e.jsxs("p",{className:"text-warm-600 text-sm text-center mb-2",children:["Tens a certeza que queres eliminar ",e.jsx("strong",{className:"text-warm-900",children:n.name}),"?"]}),e.jsx("p",{className:"text-red-600 text-xs text-center bg-red-50 border border-red-200 rounded-xl px-4 py-3 mb-6",children:"Esta aÃ§Ã£o Ã© permanente. Todos os dados e fotos serÃ£o eliminados e nÃ£o podem ser recuperados."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:o,disabled:h,className:"flex-1 flex items-center justify-center gap-2 bg-red-500 hover:bg-red-600 disabled:opacity-60 text-white font-semibold py-3 rounded-xl transition-colors",children:[h?e.jsx(E,{}):null,h?"A eliminarâ€¦":"Sim, eliminar"]}),e.jsx("button",{onClick:v,disabled:h,className:"flex-1 py-3 rounded-xl border border-warm-200 text-warm-700 font-semibold hover:bg-warm-100 transition-colors",children:"Cancelar"})]})]})})}function X({dogs:n,onRefresh:o,onAdd:v,onEdit:h,onLogout:l}){const[m,i]=a.useState(""),[b,x]=a.useState(null),[y,f]=a.useState(null),[C,N]=a.useState(!1),S=n.filter(t=>t.name.toLowerCase().includes(m.toLowerCase()));async function z(t){if(!(!r||b)){x(t.id);try{await r.from("dogs").update({is_adopted:!t.is_adopted,updated_at:new Date().toISOString()}).eq("id",t.id),o()}finally{x(null)}}}async function k(t){if(r){N(!0);try{const d=F(t.name),{data:A}=await r.storage.from("dog-photos").list(d);if(A&&A.length>0){const P=A.map(L=>`${d}/${L.name}`);await r.storage.from("dog-photos").remove(P)}await r.from("dogs").delete().eq("id",t.id),f(null),o()}finally{N(!1)}}}return e.jsxs(e.Fragment,{children:[y&&e.jsx(J,{dog:y,onConfirm:()=>k(y),onCancel:()=>!C&&f(null),deleting:C}),e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ¾"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-warm-900 text-sm",children:"CAPA PVL"}),e.jsx("span",{className:"text-warm-400 text-xs ml-2",children:"Admin"})]})]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-sm text-warm-600 hover:text-warm-900 font-medium px-3 py-2 rounded-lg hover:bg-warm-100 transition-colors",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:[e.jsx("path",{fillRule:"evenodd",d:"M3 4.25A2.25 2.25 0 015.25 2h5.5A2.25 2.25 0 0113 4.25v2a.75.75 0 01-1.5 0v-2a.75.75 0 00-.75-.75h-5.5a.75.75 0 00-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 00.75-.75v-2a.75.75 0 011.5 0v2A2.25 2.25 0 0110.75 18h-5.5A2.25 2.25 0 013 15.75V4.25z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M19 10a.75.75 0 00-.75-.75H8.704l1.048-1.04a.75.75 0 10-1.004-1.115l-2.5 2.25a.75.75 0 000 1.11l2.5 2.25a.75.75 0 101.004-1.115l-1.048-1.04h9.546A.75.75 0 0019 10z",clipRule:"evenodd"})]}),"Sair"]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-warm-900",children:"CÃ£es"}),e.jsxs("p",{className:"text-warm-500 text-sm mt-0.5",children:[n.length," total Â· ",n.filter(t=>!t.is_adopted).length," disponÃ­veis Â· ",n.filter(t=>t.is_adopted).length," adotados"]})]}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 bg-primary-500 hover:bg-primary-600 text-white font-semibold px-5 py-2.5 rounded-xl transition-colors shadow-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})}),"Adicionar CÃ£o"]})]}),e.jsxs("div",{className:"relative mb-6 max-w-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4 text-warm-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("path",{fillRule:"evenodd",d:"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z",clipRule:"evenodd"})}),e.jsx("input",{type:"search",value:m,onChange:t=>i(t.target.value),placeholder:"Pesquisar por nomeâ€¦",className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-warm-200 bg-white text-warm-900 placeholder-warm-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-primary-400"})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm overflow-hidden",children:S.length===0?e.jsxs("div",{className:"py-20 text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ¾"}),e.jsx("p",{className:"text-warm-500 font-medium",children:"Nenhum cÃ£o encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-warm-100 bg-warm-50",children:[e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3 w-14",children:"Foto"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3",children:"Nome"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden sm:table-cell",children:"Tamanho"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden md:table-cell",children:"Sexo"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3 hidden lg:table-cell",children:"Idade"}),e.jsx("th",{className:"text-left text-xs font-semibold text-warm-500 uppercase tracking-wide px-4 py-3",children:"Estado"}),e.jsx("th",{className:"text-right text-xs font-semibold text-warm-500 uppercase tracking-wide px-5 py-3",children:"AÃ§Ãµes"})]})}),e.jsx("tbody",{className:"divide-y divide-warm-100",children:S.map(t=>e.jsxs("tr",{className:`hover:bg-warm-50 transition-colors ${t.is_adopted?"opacity-50":""}`,children:[e.jsx("td",{className:"px-5 py-3",children:e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-warm-100 flex-shrink-0",children:t.photo_url?e.jsx("img",{src:t.photo_url,alt:t.name,className:"w-full h-full object-cover",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-warm-300 text-lg",children:"ðŸ¶"})})}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:"font-semibold text-warm-900",children:t.name})}),e.jsx("td",{className:"px-4 py-3 hidden sm:table-cell",children:e.jsx("span",{className:"text-warm-600",children:U[t.size]??t.size})}),e.jsx("td",{className:"px-4 py-3 hidden md:table-cell",children:e.jsx("span",{className:"text-warm-600",children:t.sex?V[t.sex]:"â€”"})}),e.jsx("td",{className:"px-4 py-3 hidden lg:table-cell",children:e.jsx("span",{className:"text-warm-600",children:t.age||"â€”"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>z(t),disabled:b===t.id,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold transition-colors ${t.is_adopted?"bg-nature-100 text-nature-700 hover:bg-nature-200":"bg-primary-100 text-primary-700 hover:bg-primary-200"}`,title:t.is_adopted?"Marcar como disponÃ­vel":"Marcar como adotado",children:[b===t.id?e.jsx(E,{size:"sm"}):e.jsx("span",{children:t.is_adopted?"âœ“":"â—‹"}),t.is_adopted?"Adotado":"DisponÃ­vel"]})}),e.jsx("td",{className:"px-5 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>h(t),className:"p-2 text-warm-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Editar",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:[e.jsx("path",{d:"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"}),e.jsx("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"})]})}),e.jsx("button",{onClick:()=>f(t),className:"p-2 text-warm-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{fillRule:"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z",clipRule:"evenodd"})})})]})})]},t.id))})]})})}),e.jsxs("p",{className:"text-xs text-warm-400 text-center mt-6",children:[S.length," de ",n.length," cÃ£o(Ãµes) listados"]})]})]})]})}function K(){const[n,o]=a.useState(!1),[v,h]=a.useState(!1),[l,m]=a.useState("dashboard"),[i,b]=a.useState(null),[x,y]=a.useState([]),[f,C]=a.useState(!1);a.useEffect(()=>{if(!r){o(!0);return}r.auth.getUser().then(({data:A})=>{h(!!A.user),o(!0)});const{data:{subscription:d}}=r.auth.onAuthStateChange((A,P)=>{h(!!P?.user)});return()=>d.unsubscribe()},[]),a.useEffect(()=>{v&&N()},[v]);async function N(){if(r){C(!0);try{const{data:d}=await r.from("dogs").select("*").order("created_at",{ascending:!1});y(d??[])}finally{C(!1)}}}async function S(){r&&(await r.auth.signOut(),h(!1),m("dashboard"))}function z(d){b(d),m("edit")}function k(){m("dashboard"),b(null),N()}function t(){m("dashboard"),b(null)}if(!n)return e.jsx("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center",children:e.jsx(E,{size:"lg"})});if(!v)return e.jsx(O,{onLogin:()=>h(!0)});if(l==="add")return e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center gap-3",children:[e.jsx("button",{onClick:t,className:"p-2 text-warm-500 hover:text-warm-900 hover:bg-warm-100 rounded-lg transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-warm-900 text-sm",children:"Adicionar CÃ£o"}),e.jsx("p",{className:"text-warm-400 text-xs",children:"Novo registo"})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm p-6 sm:p-8",children:e.jsx(T,{initial:G,onSave:k,onCancel:t})})})]});if(l==="edit"&&i){const d={name:i.name,size:i.size,sex:i.sex??"",age:i.age??"",description:i.description??""};return e.jsxs("div",{className:"min-h-screen bg-warm-50",children:[e.jsx("header",{className:"bg-white border-b border-warm-200 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center gap-3",children:[e.jsx("button",{onClick:t,className:"p-2 text-warm-500 hover:text-warm-900 hover:bg-warm-100 rounded-lg transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"font-bold text-warm-900 text-sm",children:["Editar: ",i.name]}),e.jsx("p",{className:"text-warm-400 text-xs",children:"Alterar informaÃ§Ãµes"})]})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-2xl border border-warm-200 shadow-sm p-6 sm:p-8",children:e.jsx(T,{initial:d,existingDog:i,onSave:k,onCancel:t})})})]})}return f?e.jsxs("div",{className:"min-h-screen bg-warm-50 flex items-center justify-center gap-3 text-warm-500",children:[e.jsx(E,{size:"lg"}),e.jsx("span",{className:"font-medium",children:"A carregarâ€¦"})]}):e.jsx(X,{dogs:x,onRefresh:N,onAdd:()=>m("add"),onEdit:z,onLogout:S})}export{K as default};
